CREATE TABLE CATEGORIES_CHAMBRES
(CODCAT VARCHAR2 (3) PRIMARY KEY,
NOMCAT VARCHAR2 (15)
);

CREATE TABLE CLIENTS
(CODCLI NUMBER(5) PRIMARY KEY,
NOMCLI VARCHAR2 (15),
PRECLI  VARCHAR2 (15),
EMAILCLI   VARCHAR2 (50)
);

CREATE TABLE VILLES
(CP NUMBER(6) PRIMARY KEY,
NOMVIL VARCHAR2 (20),
TAXEVIL  NUMBER (5,2)
);

CREATE TABLE HOTELS
(CODHOT NUMBER(5) PRIMARY KEY,
NOMHOT VARCHAR2 (30),
CP_CONTIENT NUMBER (6),
FOREIGN KEY (CP_CONTIENT) REFERENCES VILLES(CP)
);

CREATE TABLE JOURS
(CODJOUR NUMBER(2) PRIMARY KEY,
LIBJOUR   VARCHAR2 (10),
CODJOURACCESS NUMBER(2)
);

CREATE TABLE OFFRIR
(CODHOT NUMBER(5),
CODCAT VARCHAR2 (3),
NBCHAMBRES NUMBER(3),
PRIMARY KEY (CODHOT,CODCAT),
CONSTRAINT FK1 FOREIGN KEY (CODHOT) REFERENCES HOTELS(CODHOT),
CONSTRAINT FK2 FOREIGN KEY (CODCAT) REFERENCES CATEGORIES_CHAMBRES(CODCAT)
);

CREATE TABLE RESERVER
(CODHOT NUMBER(5),
CODCLI NUMBER(5),
CODCAT VARCHAR2 (3),
DTDEBUT VARCHAR2(10),
DTFIN VARCHAR2(10),
PRIMARY KEY (CODHOT,CODCLI,CODCAT,DTDEBUT),
CONSTRAINT FK3 FOREIGN KEY (CODHOT) REFERENCES HOTELS(CODHOT),
CONSTRAINT FK4 FOREIGN KEY (CODCLI) REFERENCES CLIENTS(CODCLI),
CONSTRAINT FK5 FOREIGN KEY (CODCAT) REFERENCES CATEGORIES_CHAMBRES(CODCAT)
);

CREATE TABLE SEMAINE
(SEMAINE VARCHAR2(50) PRIMARY KEY
);

CREATE TABLE TARIFS
(CODHOT NUMBER(5),
CODJOUR NUMBER(2),
CODCAT VARCHAR2 (3),
PRIXNUIT NUMBER(5,2),
PRIMARY KEY (CODHOT,CODJOUR,CODCAT),
CONSTRAINT FK6 FOREIGN KEY (CODHOT) REFERENCES HOTELS(CODHOT),
CONSTRAINT FK7 FOREIGN KEY (CODCAT) REFERENCES CATEGORIES_CHAMBRES(CODCAT),
CONSTRAINT FK8 FOREIGN KEY (CODJOUR) REFERENCES JOURS(CODJOUR)
);

INSERT INTO CATEGORIES_CHAMBRES VALUES ('CD','Double');
INSERT INTO CATEGORIES_CHAMBRES VALUES ('CR','Suite Royale');
INSERT INTO CATEGORIES_CHAMBRES VALUES ('CSI','Simple');
INSERT INTO CATEGORIES_CHAMBRES VALUES ('CSU','Suite');

INSERT INTO JOURS VALUES (1,'Lundi',2);
INSERT INTO JOURS VALUES (2,'Mardi',3);
INSERT INTO JOURS VALUES (3,'Mercredi',4);
INSERT INTO JOURS VALUES (4,'Jeudi',5);
INSERT INTO JOURS VALUES (5,'Vendredi',6);
INSERT INTO JOURS VALUES (6,'Samedi',7);
INSERT INTO JOURS VALUES (7,'Dimanche',1);

INSERT INTO VILLES VALUES (6000,'Nice',1);
INSERT INTO VILLES VALUES (13000,'Marseille',1.1);
INSERT INTO VILLES VALUES (14900,'Champignac',1.3);
INSERT INTO VILLES VALUES (31000,'Toulouse',0.4);
INSERT INTO VILLES VALUES (75000,'Paris',1.3);
INSERT INTO VILLES VALUES (83000,'Canne',null);
INSERT INTO VILLES VALUES (91120,'Palaiseau',0.4);
INSERT INTO VILLES VALUES (91400,'Orsay',0);
INSERT INTO VILLES VALUES (94260,'Fresnes',0.35);

INSERT INTO HOTELS VALUES (1,'Campanil',94260);
INSERT INTO HOTELS VALUES (2,'Concord Lafayette',75000);
INSERT INTO HOTELS VALUES (3,'Hilton',75000);
INSERT INTO HOTELS VALUES (4,'Napoléon',75000);
INSERT INTO HOTELS VALUES (5,'Crown Plaza',31000);
INSERT INTO HOTELS VALUES (6,'Hotel de France',13000);
INSERT INTO HOTELS VALUES (7,'Majestic',6000);
INSERT INTO HOTELS VALUES (8,'Hotel de La Gare',14900);
INSERT INTO HOTELS VALUES (9,'Hilton',6000);

INSERT INTO TARIFS VALUES (1,1,'CSI',63.00);
INSERT INTO TARIFS VALUES (1,2,'CSI',63.00);
INSERT INTO TARIFS VALUES (1,3,'CSI',63.00);
INSERT INTO TARIFS VALUES (1,4,'CSI',63.00);
INSERT INTO TARIFS VALUES (1,5,'CSI',39.00);
INSERT INTO TARIFS VALUES (1,6,'CSI',39.00);
INSERT INTO TARIFS VALUES (1,7,'CSI',63.00);
INSERT INTO TARIFS VALUES (2,1,'CD',215.00);
INSERT INTO TARIFS VALUES (2,1,'CSI',175.00);
INSERT INTO TARIFS VALUES (2,2,'CD',215.00);
INSERT INTO TARIFS VALUES (2,2,'CSI',175.00);
INSERT INTO TARIFS VALUES (2,3,'CD',215.00);
INSERT INTO TARIFS VALUES (2,3,'CSI',175.00);
INSERT INTO TARIFS VALUES (2,4,'CD',215.00);
INSERT INTO TARIFS VALUES (2,4,'CSI',175.00);
INSERT INTO TARIFS VALUES (2,5,'CD',205.00);
INSERT INTO TARIFS VALUES (2,5,'CSI',165.00);
INSERT INTO TARIFS VALUES (2,6,'CD',205.00);
INSERT INTO TARIFS VALUES (2,6,'CSI',165.00);
INSERT INTO TARIFS VALUES (2,7,'CD',205.00);
INSERT INTO TARIFS VALUES (2,7,'CSI',165.00);
INSERT INTO TARIFS VALUES (3,1,'CD',400.00);
INSERT INTO TARIFS VALUES (3,1,'CR',870.00);
INSERT INTO TARIFS VALUES (3,1,'CSU',549.00);
INSERT INTO TARIFS VALUES (3,2,'CD',400.00);
INSERT INTO TARIFS VALUES (3,2,'CR',870.00);
INSERT INTO TARIFS VALUES (3,2,'CSU',549.00);
INSERT INTO TARIFS VALUES (3,3,'CD',400.00);
INSERT INTO TARIFS VALUES (3,3,'CR',870.00);
INSERT INTO TARIFS VALUES (3,3,'CSU',549.00);
INSERT INTO TARIFS VALUES (3,4,'CD',400.00);
INSERT INTO TARIFS VALUES (3,4,'CR',849.00);
INSERT INTO TARIFS VALUES (3,4,'CSU',549.00);
INSERT INTO TARIFS VALUES (3,5,'CD',379.00);
INSERT INTO TARIFS VALUES (3,5,'CR',849.00);
INSERT INTO TARIFS VALUES (3,5,'CSU',549.00);
INSERT INTO TARIFS VALUES (3,6,'CD',404.00);
INSERT INTO TARIFS VALUES (3,6,'CR',829.00);
INSERT INTO TARIFS VALUES (3,6,'CSU',549.00);
INSERT INTO TARIFS VALUES (3,7,'CD',354.00);
INSERT INTO TARIFS VALUES (3,7,'CR',779.00);
INSERT INTO TARIFS VALUES (3,7,'CSU',549.00);
INSERT INTO TARIFS VALUES (4,1,'CSI',198.00);
INSERT INTO TARIFS VALUES (4,1,'CSU',299.00);
INSERT INTO TARIFS VALUES (4,2,'CSI',198.00);
INSERT INTO TARIFS VALUES (4,2,'CSU',341.00);
INSERT INTO TARIFS VALUES (4,3,'CD',217.00);
INSERT INTO TARIFS VALUES (4,3,'CSI',198.00);
INSERT INTO TARIFS VALUES (4,3,'CSU',341.00);
INSERT INTO TARIFS VALUES (4,4,'CD',217.00);
INSERT INTO TARIFS VALUES (4,4,'CSI',198.00);
INSERT INTO TARIFS VALUES (4,4,'CSU',341.00);
INSERT INTO TARIFS VALUES (4,5,'CD',217.00);
INSERT INTO TARIFS VALUES (4,5,'CSI',198.00);
INSERT INTO TARIFS VALUES (4,5,'CSU',341.00);
INSERT INTO TARIFS VALUES (4,6,'CD',217.00);
INSERT INTO TARIFS VALUES (4,6,'CSI',198.00);
INSERT INTO TARIFS VALUES (4,6,'CSU',341.00);
INSERT INTO TARIFS VALUES (4,7,'CD',175.00);
INSERT INTO TARIFS VALUES (4,7,'CSI',198.00);
INSERT INTO TARIFS VALUES (4,7,'CSU',341.00);

INSERT INTO CLIENTS VALUES (1,'Barthez','Fabien','Barthez@free.fr');
INSERT INTO CLIENTS VALUES (2,'Lizarazu','Bixente','Lizarazu@univ-tlse1.fr');
INSERT INTO CLIENTS VALUES (3,'Boghossian','Alain','Boghossian@univ-tlse1.fr');
INSERT INTO CLIENTS VALUES (4,'Thuram','Lilian','Thuram@free.fr');
INSERT INTO CLIENTS VALUES (5,'Blanc','Laurent','Blanc@cegetel.net');
INSERT INTO CLIENTS VALUES (6,'Deschamps','Didier','Deschamps@club-internet.fr');
INSERT INTO CLIENTS VALUES (7,'Petit','Emmanuel','Petit@cegetel.net');
INSERT INTO CLIENTS VALUES (8,'Djorkaeff','Youri','Djorkaeff@free.fr');
INSERT INTO CLIENTS VALUES (9,'Henry','Thierry','Henry@univ-tlse1.fr');
INSERT INTO CLIENTS VALUES (10,'Zidane','Zinedine','Zidane@club-internet.fr');
INSERT INTO CLIENTS VALUES (11,'Trezeguet','David','Trezegue@free.fr');
INSERT INTO CLIENTS VALUES (12,'Kopke','Andreas','Kopke@free.fr');
INSERT INTO CLIENTS VALUES (13,'Kohler','Jurgen','Kohler@free.fr');
INSERT INTO CLIENTS VALUES (14,'Sammer','Matthias','Sammer@univ-tlse1.fr');
INSERT INTO CLIENTS VALUES (15,'Heinrich','','Heinrich@cegetel.net');
INSERT INTO CLIENTS VALUES (16,'Helmer','','Helmer@free.fr');
INSERT INTO CLIENTS VALUES (17,'Eilts','','Eilts@club-internet.fr');
INSERT INTO CLIENTS VALUES (18,'Hassler','','Hassler@free.fr');
INSERT INTO CLIENTS VALUES (19,'Moller','Andreas','Moller@cegetel.net');
INSERT INTO CLIENTS VALUES (20,'Ziege','','Ziege@free.fr');
INSERT INTO CLIENTS VALUES (21,'Bierhoff','Oliver','Bierhoff@yahoo.fr');
INSERT INTO CLIENTS VALUES (22,'Klinsmann','Jurgen','Klinsmann@univ-tlse1.fr');
INSERT INTO CLIENTS VALUES (23,'Seaman','David','Seaman@club-internet.fr');
INSERT INTO CLIENTS VALUES (24,'Neville','Phil','Neville@free.fr');
INSERT INTO CLIENTS VALUES (25,'Southgate','','Southgate@cegetel.net');
INSERT INTO CLIENTS VALUES (26,'Le Saux','','Le Saux@free.fr');
INSERT INTO CLIENTS VALUES (27,'Campbell','Sol','Campbell@club-internet.fr');
INSERT INTO CLIENTS VALUES (28,'Gascoigne','Paul','Gascoigne@free.fr');
INSERT INTO CLIENTS VALUES (29,'Ince','Paul','Ince@univ-tlse1.fr');
INSERT INTO CLIENTS VALUES (30,'Batty','','Batty@cegetel.net');
INSERT INTO CLIENTS VALUES (31,'Beckham','David','Beckham@free.fr');
INSERT INTO CLIENTS VALUES (32,'Shearer','Alan','Shearer@yahoo.fr');
INSERT INTO CLIENTS VALUES (33,'Sheringham','Teddy','Sheringham@free.fr');
INSERT INTO CLIENTS VALUES (34,'Dida','','Dida@univ-tlse1.fr');
INSERT INTO CLIENTS VALUES (35,'Cafu','','Cafu@free.fr');
INSERT INTO CLIENTS VALUES (36,'Goncalves','','Goncalves@club-internet.fr');
INSERT INTO CLIENTS VALUES (37,'Carlos','Roberto','Carlos@cegetel.net');
INSERT INTO CLIENTS VALUES (38,'Aldair','','Aldair@free.fr');
INSERT INTO CLIENTS VALUES (39,'Conceicao','Flavio','Conceicao@yahoo.fr');
INSERT INTO CLIENTS VALUES (40,'Dunga','','Dunga@univ-tlse1.fr');
INSERT INTO CLIENTS VALUES (41,'Leonardo','','Leonardo@cegetel.net');
INSERT INTO CLIENTS VALUES (42,'Denilson','','Denilson@free.fr');
INSERT INTO CLIENTS VALUES (43,'Ronaldo','','Ronaldo@free.fr');
INSERT INTO CLIENTS VALUES (44,'Romario','','Romario@free.fr');
INSERT INTO CLIENTS VALUES (45,'Pires','Robert','Pires@free.fr');
INSERT INTO CLIENTS VALUES (46,'Leboeuf','Franck','Leboeuf@cegetel.net');
INSERT INTO CLIENTS VALUES (47,'Maldini','Paolo','Maldini@free.fr');
INSERT INTO CLIENTS VALUES (48,'Baggio','Roberto','Baggio@univ-tlse1.fr');
INSERT INTO CLIENTS VALUES (49,'Baggio','Dino','Baggio@free.fr');
INSERT INTO CLIENTS VALUES (50,'Del Piero','Alessandro','De-Piero@club-internet.fr');
INSERT INTO CLIENTS VALUES (51,'Peruzzi','Angelo','Peruzzi@free.fr');
INSERT INTO CLIENTS VALUES (52,'Vieri','Christian','Vieri@yahoo.fr');
INSERT INTO CLIENTS VALUES (53,'De Boer','Ronald','De Boer@free.fr');
INSERT INTO CLIENTS VALUES (54,'De Boer','Franck','De Boer@club-internet.fr');
INSERT INTO CLIENTS VALUES (55,'Berkamp','Dennis','Berkamp@yahoo.fr');
INSERT INTO CLIENTS VALUES (56,'Overmars','Marc','Overmars@free.fr');
INSERT INTO CLIENTS VALUES (57,'Suker','Davor','Suker@yahoo.fr');
INSERT INTO CLIENTS VALUES (58,'Jarny','','Jarny@free.fr');
INSERT INTO CLIENTS VALUES (59,'Chilavert','José-Luis','Chilavert@univ-tlse1.fr');
INSERT INTO CLIENTS VALUES (60,'Battistuta','Gabriele','Battistuta@cegetel.net');
INSERT INTO CLIENTS VALUES (61,'Zanetti','Javier','Zanetti@cegetel.net');
INSERT INTO CLIENTS VALUES (62,'Veron','Juan-Sebastian','Veron@free.fr');
INSERT INTO CLIENTS VALUES (63,'Flinn','Errol','');
INSERT INTO CLIENTS VALUES (64,'Baker','Joséphine','');

INSERT INTO RESERVER VALUES (1,1,'CSI','1/2/2008','2/2/2008');
INSERT INTO RESERVER VALUES (1,2,'CD','1/2/2008','2/2/2008');
INSERT INTO RESERVER VALUES (1,2,'CSI','1/3/2008','4/3/2008');
INSERT INTO RESERVER VALUES (3,31,'CD','1/4/2007','15/4/2007');
INSERT INTO RESERVER VALUES (3,31,'CR','1/4/2007','15/4/2007');
INSERT INTO RESERVER VALUES (4,5,'CD','15/2/2008','17/2/2008');
INSERT INTO RESERVER VALUES (4,63,'CD','2/4/1951','10/4/1951');
INSERT INTO RESERVER VALUES (4,63,'CSU','1/4/1950','5/4/1950');
INSERT INTO RESERVER VALUES (4,64,'CSU','1/4/1930','1/5/1930');
INSERT INTO RESERVER VALUES (5,7,'CR','1/3/2008','3/3/2008');

INSERT INTO OFFRIR VALUES (1,'CD',15);
INSERT INTO OFFRIR VALUES (1,'CSI',7);
INSERT INTO OFFRIR VALUES (2,'CD',20);
INSERT INTO OFFRIR VALUES (2,'CR',4);
INSERT INTO OFFRIR VALUES (2,'CSU',5);
INSERT INTO OFFRIR VALUES (3,'CD',25);
INSERT INTO OFFRIR VALUES (3,'CR',3);
INSERT INTO OFFRIR VALUES (3,'CSI',12);
INSERT INTO OFFRIR VALUES (3,'CSU',9);
INSERT INTO OFFRIR VALUES (4,'CD',50);
INSERT INTO OFFRIR VALUES (4,'CSI',30);
INSERT INTO OFFRIR VALUES (5,'CD',40);
INSERT INTO OFFRIR VALUES (5,'CR',2);
INSERT INTO OFFRIR VALUES (5,'CSI',10);
INSERT INTO OFFRIR VALUES (5,'CSU',12);
INSERT INTO OFFRIR VALUES (6,'CD',17);
INSERT INTO OFFRIR VALUES (6,'CSI',17);
INSERT INTO OFFRIR VALUES (6,'CSU',1);
INSERT INTO OFFRIR VALUES (7,'CD',100);
INSERT INTO OFFRIR VALUES (7,'CR',21);
INSERT INTO OFFRIR VALUES (7,'CSU',42);
INSERT INTO OFFRIR VALUES (8,'CD',14);
INSERT INTO OFFRIR VALUES (9,'CD',35);
INSERT INTO OFFRIR VALUES (9,'CR',26);
INSERT INTO OFFRIR VALUES (9,'CSI',10);
INSERT INTO OFFRIR VALUES (9,'CSU',26);

INSERT INTO SEMAINE VALUES ('Dimanche 11 Mars 2007');
INSERT INTO SEMAINE VALUES ('Lundi 12 Mars 2007');
INSERT INTO SEMAINE VALUES ('Mardi 13 Mars 2007');
INSERT INTO SEMAINE VALUES ('Mercredi 14 Mars 2007');
INSERT INTO SEMAINE VALUES ('Jeudi 15 Mars 2007');
INSERT INTO SEMAINE VALUES ('Vendredi 16 Mars 2007');
INSERT INTO SEMAINE VALUES ('Samedi 17 Mars 2007');

SELECT LIBJOUR
FROM JOURS;

SELECT NOMHOT
FROM HOTELS
WHERE CP_CONTIENT = 75000;

SELECT CLIENTS.NOMCLI 
FROM CLIENTS
WHERE CLIENTS.CODCLI NOT IN(SELECT RESERVER.CODCLI FROM RESERVER);

SELECT DISTINCT NOMHOT 
FROM HOTELS JOIN OFFRIR ON HOTELS.CODHOT = OFFRIR.CODHOT
WHERE OFFRIR.CODCAT != 'CSI';

SELECT NOMHOT, OFFRIR.CODCAT
FROM HOTELS JOIN OFFRIR ON HOTELS.CODHOT = OFFRIR.CODHOT
GROUP BY OFFRIR.CODCAT, NOMHOT;


